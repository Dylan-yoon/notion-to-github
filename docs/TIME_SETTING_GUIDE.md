## 🕒 동기화 시간 설정 가이드 (Time Configuration)

이 프로젝트는 기본적으로 **한국 시간 매일 00:05**에 실행되어, **어제 작성한 TIL**을 가져오도록 설정되어 있습니다.

실행 시간을 변경하고 싶다면 **두 가지 파일**을 수정해야 합니다.

1. `workflows/*.yml`: 언제 실행할지 결정 (UTC 기준)
2. `update_readme.py`: 며칠 날짜의 데이터를 가져올지 결정 (어제 vs 오늘)

---

### 1단계: 언제 실행할 것인가? (`.yml` 수정)

GitHub Actions는 전 세계 표준 시간인 **UTC**를 사용합니다. 한국 시간(KST)은 UTC보다 **9시간 빠릅니다.**

**파일 경로:** `.github/workflows/update_notion.yml`

```yaml
on:
  schedule:
    # ⚠️ 수정할 부분: cron 표현식
    # 분 시 일 월 요일 (UTC 기준)
    - cron: '5 15 * * *' 

```

#### 📌 시간 변환 공식

> **설정할 UTC 시간 = 한국 시간(KST) - 9시간**

| 목표 실행 시간 (한국 KST) | 설정해야 할 값 (UTC) | Cron 표현식 | 비고 |
| --- | --- | --- | --- |
| **새벽 00:05 (기본값)** | 전날 15:05 | `'5 15 * * *'` | 어제 날짜 데이터 수집 추천 |
| **아침 09:00** | 당일 00:00 | `'0 0 * * *'` | 어제 날짜 데이터 수집 추천 |
| **오후 23:50 (밤)** | 당일 14:50 | `'50 14 * * *'` | **당일** 날짜 데이터 수집 추천 |

---

### 2단계: 어떤 날짜의 글을 가져올 것인가? (`.py` 수정)

실행 시간에 따라 "어제 쓴 글"을 가져올지, "오늘 쓴 글"을 가져올지 파이썬 코드에서 정해야 합니다.

**파일 경로:** `update_readme.py`

#### 🅰️ 자정(00시) 이후에 실행하는 경우 (기본값)

자정이 지났으므로 **"어제(D-1)"** 작성한 글을 찾아야 합니다. 코드를 그대로 두시면 됩니다.

```python
def main():
    kst = timezone(timedelta(hours=TIMEZONE_HOURS))
    
    # ✅ (기본) 현재 시간에서 1일을 빼서 '어제' 날짜를 타겟팅
    target_date = (datetime.now(kst) - timedelta(days=1)).strftime("%Y-%m-%d")

```

#### 🅱️ 자정(00시) 이전에 실행하는 경우 (당일 백업)

만약 밤 11시 50분에 실행해서 **"오늘(D-Day)"** 쓴 글을 바로 올리고 싶다면 `timedelta` 부분을 수정해야 합니다.

```python
def main():
    kst = timezone(timedelta(hours=TIMEZONE_HOURS))
    
    # ✅ (수정) 1일을 빼는 부분을 삭제하여 '오늘' 날짜를 타겟팅
    target_date = datetime.now(kst).strftime("%Y-%m-%d") 

```

---

### 💡 요약 예시

#### 예시 1: "저는 아침 6시에 일어나서 어제 쓴 글이 올라왔는지 보고 싶어요."

1. **Workflow (`.yml`):** 한국 06:00 → UTC 21:00 (전날)
* `- cron: '0 21 * * *'`


2. **Python (`.py`):** 아침이므로 "어제" 글을 가져와야 함.
* `target_date = (datetime.now(kst) - timedelta(days=1))...` (수정 안 함)



#### 예시 2: "저는 자기 전(밤 11시 55분)에 오늘 쓴 글을 백업하고 싶어요."

1. **Workflow (`.yml`):** 한국 23:55 → UTC 14:55
* `- cron: '55 14 * * *'`


2. **Python (`.py`):** 아직 자정이 안 지났으므로 "오늘" 글을 가져와야 함.
* `target_date = datetime.now(kst).strftime("%Y-%m-%d")` (`- timedelta` 삭제)



---

### ⚠️ 주의사항
**Notion 데이터가 비어있다면?**<br>
설정한 날짜(`target_date`)에 해당하는 노션 페이지가 하나도 없으면 아무런 파일도 생성되지 않습니다.

**시간 오차**<br>
GitHub Actions 서버 상황에 따라 설정한 시간보다 **5~10분 정도 늦게 실행**될 수 있습니다. 정각에 딱 맞춰 실행되지 않으니 여유를 두세요.

추가적으로 Github에서 시간에 맞춰 자동화를 걸어두게 된다면, 시간의 오차가 발생합니다.<br>
현재 기본값으로 `금일 11시 5분`이 아닌 다음날 `00시 5분` 으로 맞추어 놓은 이유는,<br>
실행 오차로 인해 안전하게 실행시키기 위함입니다.<br>

잘 확인하시고 적용하시길 바랍니다.
